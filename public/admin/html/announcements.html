<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin Dashboard | Announcements Management</title>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

  <!-- Shared + Page-specific CSS -->
  <link rel="stylesheet" href="../css/admin-styles.css" />
  <link rel="stylesheet" href="../css/announcements.css" />
</head>
<body>

  <!-- Menu Toggle (Mobile) -->
  <button class="menu-toggle" id="menuToggle">
    <i class="fas fa-bars"></i>
  </button>

  <!-- Sidebar Overlay -->
  <div class="sidebar-overlay" id="sidebarOverlay"></div>

  <!-- Notification Container -->
  <div class="notification-container" id="notificationContainer"></div>

  <div class="dashboard-container">
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <h2><i class="fas fa-chart-line"></i> Admin Panel</h2>
      </div>
      <nav class="sidebar-nav">
        <ul>
          <li class="nav-item"><a href="./adminDash.html"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
          <li class="nav-item"><a href="./events.html"><i class="fas fa-calendar"></i> Events</a></li>
          <li class="nav-item active"><a href="./announcements.html"><i class="fas fa-bullhorn"></i> Announcements</a></li>
          <li class="nav-item"><a href="./executives.html"><i class="fas fa-users"></i> Executives</a></li>
          <li class="nav-item"><a href="./settings.html"><i class="fas fa-cog"></i> Settings</a></li>
          <li class="nav-item"><a href="../index.html" id="logoutBtn"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
        </ul>
      </nav>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <header class="content-header">
        <div class="header-left">
          <h1>Announcements Management</h1>
          <p>Manage platform announcements</p>
        </div>
      </header>

      <div class="content-section">
        <div class="section-header">
          <h2><i class="fas fa-bullhorn"></i> Announcements</h2>
          <div>
            <button class="btn btn-primary" id="notificationBtn"><i class="fas fa-bell me-2"></i>Send Notification</button>
            <button class="btn btn-primary" id="addAnnouncementBtn"><i class="fas fa-plus me-2"></i>Add Announcement</button>
          </div>
        </div>

        <!-- Add Announcement Form (Hidden by default) -->
        <div class="form-card" id="add-announcement-form" style="display: none;">
          <h3><i class="fas fa-plus-circle me-2"></i>Add New Announcement</h3>
          
          <form id="announcement-form" enctype="multipart/form-data">
            <div class="row">
              <div class="form-group col-md-6">
                <label for="announcement-title">Announcement Title *</label>
                <input type="text" class="form-control" id="announcement-title" name="title" placeholder="Enter announcement title" required maxlength="255">
                <div class="form-error" id="title-error"></div>
              </div>
              <div class="form-group col-md-6">
                <label for="announcement-expiresAt">Expiration Date</label>
                <input type="datetime-local" class="form-control" id="announcement-expiresAt" name="expiresAt">
                <div class="form-error" id="expiresAt-error"></div>
              </div>
            </div>
            
            <div class="form-group">
              <label for="announcement-content">Content *</label>
              <textarea class="form-control" id="announcement-content" name="content" rows="6" placeholder="Enter announcement content" required></textarea>
              <div class="form-error" id="content-error"></div>
            </div>

            <!-- Image Upload Section -->
            <div class="form-group">
              <label>Images (Max 2)</label>
              <div class="file-upload-area" id="announcement-images-upload">
                <i class="fas fa-cloud-upload-alt"></i>
                <p>Drag & drop images here, or click to browse</p>
                <input type="file" id="announcement-images-files" name="images" multiple style="display: none;" accept="image/*">
                <button type="button" class="btn btn-primary" id="browse-images-btn">Browse Images</button>
                <small class="form-text">Maximum 2 images allowed. Supported formats: JPG, PNG, GIF</small>
              </div>
              <div class="file-preview" id="announcement-images-preview"></div>
              <div class="form-error" id="images-error"></div>
            </div>

            <!-- Important Announcement Toggle -->
            <div class="form-group">
              <div class="form-check">
                <input type="checkbox" class="form-check-input" id="announcement-isImportant" name="isImportant">
                <label class="form-check-label" for="announcement-isImportant">
                  Mark as Important Announcement
                </label>
              </div>
            </div>

            <div class="d-flex justify-content-end gap-2">
              <button type="button" class="btn" id="cancel-announcement">Cancel</button>
              <button type="submit" class="btn btn-primary" id="save-announcement">
                <span id="save-text">Save Announcement</span>
                <span id="save-loading" style="display: none;">
                  <i class="fas fa-spinner fa-spin"></i> Saving...
                </span>
              </button>
            </div>
          </form>
        </div>

        <!-- Announcements Grid -->
        <div class="content-grid" id="announcements-list">
          <div class="empty-state" id="empty-state">
            <i class="fas fa-bullhorn"></i>
            <p>No announcements available.</p>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- Edit Announcement Modal (Hidden by default) -->
  <div class="modal-overlay" id="editModal">
    <div class="modal">
      <div class="modal-header">
        <h3>Edit Announcement</h3>
        <button class="modal-close" id="closeEditModal">&times;</button>
      </div>
      <div class="modal-body">
        <form id="edit-announcement-form" enctype="multipart/form-data">
          <input type="hidden" id="edit-announcement-id" name="id">
          <div class="row">
            <div class="form-group col-md-6">
              <label for="edit-announcement-title">Announcement Title *</label>
              <input type="text" class="form-control" id="edit-announcement-title" name="title" required maxlength="255">
              <div class="form-error" id="edit-title-error"></div>
            </div>
            <div class="form-group col-md-6">
              <label for="edit-announcement-expiresAt">Expiration Date</label>
              <input type="datetime-local" class="form-control" id="edit-announcement-expiresAt" name="expiresAt">
              <div class="form-error" id="edit-expiresAt-error"></div>
            </div>
          </div>
          
          <div class="form-group">
            <label for="edit-announcement-content">Content *</label>
            <textarea class="form-control" id="edit-announcement-content" name="content" rows="6" required></textarea>
            <div class="form-error" id="edit-content-error"></div>
          </div>
          
          <!-- Image Upload Section in Edit Modal -->
          <div class="form-group">
            <label>Images (Max 2)</label>
            <div class="file-upload-area" id="edit-announcement-images-upload">
              <i class="fas fa-cloud-upload-alt"></i>
              <p>Drag & drop images here, or click to browse</p>
              <input type="file" id="edit-announcement-images-files" name="images" multiple style="display: none;" accept="image/*">
              <button type="button" class="btn btn-primary" id="edit-browse-images-btn">Browse Images</button>
              <small class="form-text">Maximum 2 images allowed. Supported formats: JPG, PNG, GIF</small>
            </div>
            <div class="file-preview" id="edit-announcement-images-preview"></div>
            <div class="form-error" id="edit-images-error"></div>
          </div>

          <div class="form-group">
            <div class="form-check">
              <input type="checkbox" class="form-check-input" id="edit-announcement-isImportant" name="isImportant">
              <label class="form-check-label" for="edit-announcement-isImportant">
                Mark as Important Announcement
              </label>
            </div>
          </div>

          <div class="modal-footer">
            <button type="button" class="btn" id="cancelEdit">Cancel</button>
            <button type="submit" class="btn btn-primary" id="updateAnnouncement">
              <span id="update-text">Update Announcement</span>
              <span id="update-loading" style="display: none;">
                <i class="fas fa-spinner fa-spin"></i> Updating...
              </span>
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Delete Confirmation Modal (Hidden by default) -->
  <div class="modal-overlay" id="deleteModal">
    <div class="modal">
      <div class="modal-header">
        <h3>Confirm Deletion</h3>
        <button class="modal-close" id="closeDeleteModal">&times;</button>
      </div>
      <div class="modal-body">
        <p>Are you sure you want to delete this announcement? This action cannot be undone.</p>
        <input type="hidden" id="delete-announcement-id">
      </div>
      <div class="modal-footer">
        <button type="button" class="btn" id="cancelDelete">Cancel</button>
        <button type="button" class="btn btn-danger" id="confirmDelete">
          <span id="delete-text">Delete Announcement</span>
          <span id="delete-loading" style="display: none;">
            <i class="fas fa-spinner fa-spin"></i> Deleting...
          </span>
        </button>
      </div>
    </div>
  </div>

  <!-- Shared + Page-specific JS -->
  <script src="../js/mainAuth.js"></script>
  <script src="../js/admin-common.js"></script>
  <script src="../js/announcemnet.js"></script>
  <script src="../js/dashboard.js"></script>
</body>
</html>